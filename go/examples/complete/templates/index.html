<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}}</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>{{.title}}</h1>
            <p class="subtitle">Demonstrating zero-config defaults and opt-in features</p>
            <p class="time">Server time: {{.time}}</p>
        </header>

        <section class="features">
            <h2>Feature Status</h2>
            <div class="feature-grid">
                {{range .features}}
                <div class="feature-card {{.status}}">
                    <h3>{{.name}}</h3>
                    <p class="endpoint">{{.endpoint}}</p>
                    <span class="status-badge">{{.status}}</span>
                </div>
                {{end}}
            </div>
        </section>

        <section class="demo">
            <h2>Interactive Demos</h2>
            
            <div class="demo-section">
                <h3>Authentication Test</h3>
                <p>Protected routes require Bearer tokens (via SecureAPI middleware stack)</p>
                <button onclick="testAuth('demo-token-123')">Test with Alice's Token</button>
                <button onclick="testAuth('demo-token-456')">Test with Bob's Token</button>
                <button onclick="testAuth('invalid')">Test with Invalid Token</button>
                <pre id="auth-result"></pre>
            </div>

            <div class="demo-section">
                <h3>Real-time SSE Stream</h3>
                <p>Server-Sent Events for live updates</p>
                <button onclick="startSSE()">Start Streaming</button>
                <button onclick="stopSSE()">Stop Streaming</button>
                <div id="sse-status">Not connected</div>
                <canvas id="chart" width="400" height="200"></canvas>
            </div>

            <div class="demo-section">
                <h3>File Upload</h3>
                <p>Multipart form handling demonstration</p>
                <input type="file" id="file-input">
                <button onclick="uploadFile()">Upload</button>
                <pre id="upload-result"></pre>
            </div>

            <div class="demo-section">
                <h3>Rate Limit Test</h3>
                <p>SecureAPI middleware stack includes rate limiting for /api/* routes</p>
                <button onclick="testRateLimit()">Send Rapid Requests to /api/user</button>
                <pre id="rate-limit-result"></pre>
            </div>

            <div class="demo-section">
                <h3>Error Recovery</h3>
                <p>DefaultMiddleware includes panic recovery</p>
                <button onclick="testError()">Trigger Random Error (50% panic rate)</button>
                <pre id="error-result"></pre>
            </div>

            <div class="demo-section">
                <h3>Understanding Middleware</h3>
                <div class="middleware-info">
                    <h4>DefaultMiddleware (Automatic)</h4>
                    <ul>
                        <li>MetricsMiddleware - Request counting</li>
                        <li>RequestLoggerMiddleware - Structured logs</li>
                        <li>RecoveryMiddleware - Panic recovery</li>
                    </ul>
                    
                    <h4>SecureWeb (Applied to all routes)</h4>
                    <ul>
                        <li>HeadersMiddleware - Security headers</li>
                    </ul>
                    
                    <h4>SecureAPI (Applied to /api/*)</h4>
                    <ul>
                        <li>AuthMiddleware - Bearer token validation</li>
                        <li>RateLimitMiddleware - Per-IP limiting</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <script src="/static/demo.js"></script>
</body>
</html>