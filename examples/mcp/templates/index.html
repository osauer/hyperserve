<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hyperserve MCP Example</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            background: #f5f5f5;
        }
        h1 { color: #2c3e50; }
        h2 { color: #34495e; margin-top: 2rem; }
        .card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .endpoint {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 1rem;
            margin: 0.5rem 0;
        }
        code {
            background: #e9ecef;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }
        .tool-list, .resource-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        .item {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 4px;
            border: 1px solid #dee2e6;
        }
        .item h4 { margin: 0 0 0.5rem 0; color: #495057; }
        .status { color: #28a745; font-weight: bold; }
        .info-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <h1>üöÄ Hyperserve MCP Example</h1>
    <p class="status">‚úì MCP Server Running on {{.MCPEndpoint}}</p>
    
    <div class="card">
        <h2>What is MCP?</h2>
        <p>The Model Context Protocol (MCP) enables AI assistants to interact with your server through a standardized JSON-RPC 2.0 interface. This example demonstrates hyperserve's built-in MCP support.</p>
    </div>

    <div class="card">
        <h2>Available Endpoints</h2>
        
        <div class="endpoint">
            <strong>MCP Protocol:</strong> <code>POST {{.MCPEndpoint}}</code><br>
            JSON-RPC 2.0 endpoint for AI assistant communication
        </div>
        
        <div class="endpoint">
            <strong>Health Checks:</strong><br>
            <code>GET :9080/healthz/</code> - General health<br>
            <code>GET :9080/readyz/</code> - Readiness probe<br>
            <code>GET :9080/livez/</code> - Liveness probe
        </div>
    </div>

    <div class="card">
        <h2>üõ†Ô∏è Built-in Tools</h2>
        <div class="tool-list">
            <div class="item">
                <h4>calculator</h4>
                <p>Basic math operations: add, subtract, multiply, divide</p>
            </div>
            <div class="item">
                <h4>read_file</h4>
                <p>Read files from sandbox: <code>{{.SandboxDir}}</code></p>
            </div>
            <div class="item">
                <h4>list_directory</h4>
                <p>List directory contents (sandboxed)</p>
            </div>
            <div class="item">
                <h4>http_request</h4>
                <p>Make HTTP requests to external services</p>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>üìä Built-in Resources</h2>
        <div class="resource-list">
            <div class="item">
                <h4>config://server/options</h4>
                <p>Server configuration (sanitized)</p>
            </div>
            <div class="item">
                <h4>metrics://server/stats</h4>
                <p>Performance metrics</p>
            </div>
            <div class="item">
                <h4>system://runtime/info</h4>
                <p>Runtime information</p>
            </div>
            <div class="item">
                <h4>logs://server/recent</h4>
                <p>Recent log entries</p>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>Quick Start Examples</h2>
        
        <h3>Initialize Connection</h3>
        <pre>curl -X POST http://localhost:8080{{.MCPEndpoint}} \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "initialize",
    "params": {
        "protocolVersion": "2024-11-05",
        "capabilities": {},
        "clientInfo": {"name": "test", "version": "1.0"}
    },
    "id": 1
}'</pre>

        <h3>Use Calculator</h3>
        <pre>curl -X POST http://localhost:8080{{.MCPEndpoint}} \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
        "name": "calculator",
        "arguments": {"operation": "multiply", "a": 15, "b": 4}
    },
    "id": 2
}'</pre>

        <h3>Read System Info</h3>
        <pre>curl -X POST http://localhost:8080{{.MCPEndpoint}} \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "resources/read",
    "params": {"uri": "system://runtime/info"},
    "id": 3
}'</pre>
    </div>

    <div class="info-box">
        <strong>Security Note:</strong> File operations are sandboxed to <code>{{.SandboxDir}}</code> using Go 1.24's os.Root for secure access.
    </div>
</body>
</html>